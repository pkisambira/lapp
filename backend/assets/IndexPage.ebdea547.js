var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var T=(l,a,s)=>a in l?Z(l,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[a]=s,A=(l,a)=>{for(var s in a||(a={}))le.call(a,s)&&T(l,s,a[s]);if(q)for(var s of q(a))ae.call(a,s)&&T(l,s,a[s]);return l},B=(l,a)=>ee(l,te(a));import{a as U,Q as se}from"./QPage.f25e220e.js";import{Q as w,a as m}from"./QCard.0b1691e0.js";import{C as oe,aE as ne,aF as de,E as R,F as re,T as ie,a9 as ue,au as ce,d as S,k as v,P as H,o as D,ao as I,l as e,w as t,U as k,m as _,aG as N,aj as u,ak as f,aH as K,aI as P,r as Q,am as C,ag as $,c as me}from"./vendor.73475e93.js";import{k as _e,l as pe,j,h,Q as g,g as r}from"./use-prevent-scroll.4d001d63.js";import{Q as b}from"./QSeparator.4055c39e.js";import{Q as F,a as G,u as fe,b as E}from"./index.50653893.js";import{u as L,v as ge}from"./customer-store.7d12a880.js";import{_ as J}from"./index.007cb3e3.js";import"./focus-manager.0592c663.js";import"./scroll.80d62650.js";import"./index.esm2017.dd488813.js";var M=oe({name:"QCardActions",props:B(A({},ne),{vertical:Boolean}),setup(l,{slots:a}){const s=de(l),d=R(()=>`q-card__actions ${s.value} q-card__actions--${l.vertical===!0?"vert column":"horiz row"}`);return()=>re("div",{class:d.value},ie(a.default))}});function z(l){if(l===!1)return 0;if(l===!0||l===void 0)return 1;const a=parseInt(l,10);return isNaN(a)?0:a}var V=ue({name:"close-popup",beforeMount(l,{value:a}){const s={depth:z(a),handler(d){s.depth!==0&&setTimeout(()=>{const c=_e(l);c!==void 0&&pe(c,d,s.depth)})},handlerKey(d){ce(d,13)===!0&&s.handler(d)}};l.__qclosepopup=s,l.addEventListener("click",s.handler),l.addEventListener("keyup",s.handlerKey)},updated(l,{value:a,oldValue:s}){a!==s&&(l.__qclosepopup.depth=z(a))},beforeUnmount(l){const a=l.__qclosepopup;l.removeEventListener("click",a.handler),l.removeEventListener("keyup",a.handlerKey),delete l.__qclosepopup}});const ve={class:"q-pa-md"},he=u("Description"),ye=u("Points"),be=u("Redeemable items"),we=S({setup(l){const a=L(),s=v(),d=v([]);return H(async()=>{d.value=await a.filteredRedeemables()}),(c,i)=>(D(),I("div",ve,[e(G,{grid:"",title:"Redeemables",rows:d.value,"row-key":"name",filter:s.value,"hide-header":"",selection:"multiple",selected:P(a).$state.selectedRedeemables,"onUpdate:selected":i[1]||(i[1]=o=>P(a).$state.selectedRedeemables=o)},{"top-right":t(()=>[e(U,{borderless:"",dense:"",debounce:"300",modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=o=>s.value=o),placeholder:"Search"},{append:t(()=>[e(k,{name:"search"})]),_:1},8,["modelValue"])]),item:t(o=>[_("div",{class:"grid-style-transition",style:K(o.selected?"transform: scale(0.95);":"")},[e(w,{class:N(o.selected?"bg-grey-2":"")},{default:t(()=>[e(m,null,{default:t(()=>[e(F,{dense:"",modelValue:o.selected,"onUpdate:modelValue":p=>o.selected=p,label:o.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),e(b),e(j,{bordered:""},{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,null,{default:t(()=>[he]),_:1}),e(r,{innerHTML:o.row.description,lines:"2",caption:""},null,8,["innerHTML"])]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,null,{default:t(()=>[ye]),_:1}),e(r,{caption:""},{default:t(()=>[u(f(o.row.points),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,null,{default:t(()=>[be]),_:1}),e(r,{caption:""},{default:t(()=>[u(f(o.row.items[0]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])],4)]),_:1},8,["rows","filter","selected"])]))}});const Ce={class:"q-pa-md"},Pe=u("Condition"),$e=u("Points"),Ve=S({setup(l){const a=fe(),s=L(),d=v();return H(()=>a.getPointsItems()),(c,i)=>(D(),I("div",Ce,[e(G,{grid:"",title:"Points Rules | items",rows:P(a).$state.pointItems,"row-key":"name",filter:d.value,"hide-header":"",selection:"single",selected:P(s).$state.selectedPoints,"onUpdate:selected":i[1]||(i[1]=o=>P(s).$state.selectedPoints=o)},{"top-right":t(()=>[e(U,{borderless:"",dense:"",debounce:"300",modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=o=>d.value=o),placeholder:"Search"},{append:t(()=>[e(k,{name:"search"})]),_:1},8,["modelValue"])]),item:t(o=>[_("div",{class:"grid-style-transition",style:K(o.selected?"transform: scale(0.95);":"")},[e(w,{class:N(o.selected?"bg-grey-2":"")},{default:t(()=>[e(m,null,{default:t(()=>[e(F,{dense:"",modelValue:o.selected,"onUpdate:modelValue":p=>o.selected=p,label:o.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),e(b),e(j,{bordered:""},{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,null,{default:t(()=>[Pe]),_:1}),e(r,{innerHTML:o.row.condition,lines:"2",caption:""},null,8,["innerHTML"])]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,null,{default:t(()=>[$e]),_:1}),e(r,{caption:""},{default:t(()=>[u(f(o.row.points),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])],4)]),_:1},8,["rows","filter","selected"])]))}}),Qe=S({name:"ScanComponent",components:{QrStream:ge.exports.QrStream,RedeemPoints:we,SelectPoints:Ve},setup(){const l=v(),a=v(),s=v(!1),d=v(!1),c=L(),i=R(()=>c.getTotalRedeemPoints),o=R(()=>c.getTotalAwardPoints),p=v(""),x=v("");async function n(y){p.value=y,a.value=await c.getCustomerByQr(y)}async function O(){const y={type:"award",date:Date.now(),points:o.value};await c.awardPoints(y)}async function W(){const y={type:"redeem",date:Date.now(),points:i.value};await c.awardPoints(y)}return c.$onAction(({name:y,store:X,after:Y})=>{y==="awardPoints"&&Y(()=>{p.value&&X.getCustomerByQr(p.value)})}),{addPoints:O,decoded:p,errorMsg:x,onDecode:n,scanCustomer:a,ptdiag:s,rddiag:d,redeemSelect:l,redeemPoints:W,total:i,awpoints:o}}}),ke={class:"grid sm:grid-cols-1 md:grid-cols-2 px-1 gap-4 w-full min-h-full relative z-10",style:{"margin-top":"-126px"}},Se=_("div",{class:"text-gray-50 text-xl"},"scan card",-1),De={class:"center"},xe=_("div",{style:{color:"red"},class:"frame"},null,-1),Re=_("div",{class:"text-gray-50 text-xl"},"Customer Details",-1),Ue={class:"p-2"},Ie=u("Details"),Le={class:"p-2 grid grid-cols-2 gap-2"},qe={class:"row items-center no-wrap"},Te=_("div",{class:"text-center"},"Award Points",-1),Ae=u("Redeem Points "),Be={class:"text-h6 text-grey-4"},Ee={class:"text-h6 text-grey-4"};function Me(l,a,s,d,c,i){const o=Q("qr-stream"),p=Q("select-points"),x=Q("redeem-points");return D(),I("div",ke,[e(w,{class:""},{default:t(()=>[e(m,{style:{"background-color":"#6c63ac"}},{default:t(()=>[Se]),_:1}),e(m,null,{default:t(()=>[_("div",De,[e(o,{onDecode:l.onDecode,class:"mb"},{default:t(()=>[xe]),_:1},8,["onDecode"])])]),_:1})]),_:1}),e(w,{class:"h-1/2"},{default:t(()=>[e(m,{style:{"background-color":"#6c63ac"}},{default:t(()=>[Re]),_:1}),e(m,null,{default:t(()=>[_("div",Ue,[e(U,{disable:!0,filled:"",color:"blue-2",modelValue:l.decoded,"onUpdate:modelValue":a[0]||(a[0]=n=>l.decoded=n),label:"Label",type:"textarea"},null,8,["modelValue"])])]),_:1}),e(w,{class:"my-card",bordered:""},{default:t(()=>[e(h,null,{default:t(()=>[e(g,{avatar:""},{default:t(()=>[e(k,{name:"person"})]),_:1}),e(g,null,{default:t(()=>[e(r,null,{default:t(()=>[Ie]),_:1}),e(r,{caption:""},{default:t(()=>{var n;return[u(f((n=l.scanCustomer)==null?void 0:n.id),1)]}),_:1})]),_:1})]),_:1}),e(b),e(m,{horizontal:""},{default:t(()=>[e(m,{class:"w-2/3"},{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,null,{default:t(()=>{var n;return[u(f((n=l.scanCustomer)==null?void 0:n.firstname),1)]}),_:1})]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,null,{default:t(()=>{var n;return[u(f((n=l.scanCustomer)==null?void 0:n.lastname),1)]}),_:1})]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,null,{default:t(()=>{var n;return[u(f((n=l.scanCustomer)==null?void 0:n.phone),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(b,{vertical:""}),e(m,{class:"w-1/3"},{default:t(()=>{var n;return[_("h2",null,f((n=l.scanCustomer)==null?void 0:n.points),1)]}),_:1})]),_:1})]),_:1}),_("div",Le,[e(C,{color:"indigo-6",onClick:a[1]||(a[1]=n=>l.ptdiag=!0),disable:l.decoded.length<1},{default:t(()=>[_("div",qe,[e(k,{left:"",name:"add"}),Te])]),_:1},8,["disable"]),e(C,{color:"indigo-6",onClick:a[2]||(a[2]=n=>l.rddiag=!0),icon:"minus",disable:l.decoded.length<1},{default:t(()=>[Ae]),_:1},8,["disable"])])]),_:1}),e(E,{modelValue:l.ptdiag,"onUpdate:modelValue":a[3]||(a[3]=n=>l.ptdiag=n),persistent:"",class:"w-1/2"},{default:t(()=>[e(w,null,{default:t(()=>[e(m,{style:{"background-color":"#6c63ac"}},{default:t(()=>[_("div",Be,"Award points "+f(l.awpoints),1)]),_:1}),e(b),e(m,{style:{"max-height":"50vh"},class:"scroll"},{default:t(()=>[e(p)]),_:1}),e(b),e(M,{align:"right"},{default:t(()=>[$(e(C,{flat:"",label:"Decline",color:"primary"},null,512),[[V]]),$(e(C,{flat:"",label:"Award",color:"primary",onClick:l.addPoints},null,8,["onClick"]),[[V]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(E,{modelValue:l.rddiag,"onUpdate:modelValue":a[4]||(a[4]=n=>l.rddiag=n),persistent:""},{default:t(()=>[e(w,null,{default:t(()=>[e(m,{style:{"background-color":"#6c63ac"}},{default:t(()=>[_("div",Ee,"Redeem points "+f(l.total),1)]),_:1}),e(b),e(m,{style:{"max-height":"50vh"},class:"scroll"},{default:t(()=>[e(x,{ref:"redeemSelect"},null,512)]),_:1}),e(b),e(M,{align:"right"},{default:t(()=>[$(e(C,{flat:"",label:"Decline",color:"primary"},null,512),[[V]]),$(e(C,{flat:"",label:"Redeem",color:"primary",onClick:l.redeemPoints},null,8,["onClick"]),[[V]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var ze=J(Qe,[["render",Me]]);const He=S({name:"IndexPage",components:{ScanComponent:ze}});function Ne(l,a,s,d,c,i){const o=Q("scan-component");return D(),me(se,{class:"row"},{default:t(()=>[e(o)]),_:1})}var lt=J(He,[["render",Ne]]);export{lt as default};
